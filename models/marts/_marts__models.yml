version: 2

models:
  - name: fct_flights
    data_tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref('stg_booking__flights')     
    columns:
      - name: flight_id
        data_tests:
          - unique
          - not_null        

  - name: fct_ticket_flights
    data_tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref('stg_booking__ticket_flights')     
    columns:
      - name: ticket_flight_id
        data_tests:
          - unique
          - not_null   

  - name: dim_booking_flights    
    columns:
      - name: book_flight_id
        data_tests:
          - unique
          - not_null   